{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/stanleyjeong/Desktop/_CODING/_PROJECTS 25 projects/z_SJ_Portfolio 2020/MEMOIR/Memoir/components/CreateAccountPopup.jsx\";\nimport React, { useEffect, useContext } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { useFonts } from 'expo-font';\nimport { useNavigation } from '@react-navigation/native';\nimport { AuthContext } from \"../components/context\";\nimport AppButton from \"./AppButton\";\nimport * as Animatable from 'react-native-animatable';\n\nvar _Dimensions$get = Dimensions.get('window'),\n    width = _Dimensions$get.width,\n    height = _Dimensions$get.height;\n\nimport firebase from 'firebase';\nvar provider = new firebase.auth.FacebookAuthProvider();\nimport * as Facebook from 'expo-facebook';\nimport * as AppleAuthentication from 'expo-apple-authentication';\nexport default function CreateAccountPopup() {\n  var navigation = useNavigation();\n\n  var _useFonts = useFonts({\n    'Assistant': require(\"../assets/fonts/Assistant/Assistant-VariableFont_wght.ttf\"),\n    'Assistant-Regular': require(\"../assets/fonts/Assistant/static/Assistant-Regular.ttf\"),\n    'Assistant-SemiBold': require(\"../assets/fonts/Assistant/static/Assistant-SemiBold.ttf\")\n  }),\n      _useFonts2 = _slicedToArray(_useFonts, 1),\n      fontsLoaded = _useFonts2[0];\n\n  var _useContext = useContext(AuthContext),\n      appleSignUp = _useContext.appleSignUp,\n      appleTokenIn = _useContext.appleTokenIn,\n      userToken = _useContext.userToken,\n      fbSignUp = _useContext.fbSignUp,\n      fbTokenIn = _useContext.fbTokenIn;\n\n  var fbAppId = \"200817071551403\";\n  var fbAppName = 'memoir';\n\n  var signInWithFacebook = function signInWithFacebook() {\n    var _await$Facebook$logIn, type, token, response, json, first_name, last_name, email, userId;\n\n    return _regeneratorRuntime.async(function signInWithFacebook$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(Facebook.initializeAsync({\n              fbAppId: fbAppId,\n              fbAppName: fbAppName\n            }));\n\n          case 2:\n            _context.next = 4;\n            return _regeneratorRuntime.awrap(Facebook.logInWithReadPermissionsAsync({\n              permissions: ['public_profile', 'email', 'user_friends']\n            }));\n\n          case 4:\n            _await$Facebook$logIn = _context.sent;\n            type = _await$Facebook$logIn.type;\n            token = _await$Facebook$logIn.token;\n            console.log(\"Token: \", token);\n\n            if (!(type === \"success\")) {\n              _context.next = 31;\n              break;\n            }\n\n            _context.next = 11;\n            return _regeneratorRuntime.awrap(fetch(\"https://graph.facebook.com/me?access_token=\" + token + \"&fields=id,first_name,last_name,email\"));\n\n          case 11:\n            response = _context.sent;\n            _context.next = 14;\n            return _regeneratorRuntime.awrap(response.json());\n\n          case 14:\n            json = _context.sent;\n            console.log(\"facebook response: \", json);\n            first_name = json[\"first_name\"];\n            last_name = json[\"last_name\"];\n            email = json[\"email\"] || null;\n            userId = json[\"id\"];\n            console.log(\"fb name stuff!: \", first_name, last_name, email, userId, token);\n            _context.prev = 21;\n            _context.next = 24;\n            return _regeneratorRuntime.awrap(fbSignUp(email, first_name, last_name, userId, token));\n\n          case 24:\n            _context.next = 29;\n            break;\n\n          case 26:\n            _context.prev = 26;\n            _context.t0 = _context[\"catch\"](21);\n            console.log(_context.t0);\n\n          case 29:\n            _context.next = 31;\n            break;\n\n          case 31:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[21, 26]], Promise);\n  };\n\n  function fbSignIn() {\n    return _regeneratorRuntime.async(function fbSignIn$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            firebase.auth().signInWithPopup(provider).then(function (result) {\n              var token = result.credential.accessToken;\n              var user = result.user;\n            }).catch(function (error) {\n              console.log(error.code);\n              console.log(error.message);\n            });\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  ;\n\n  var signInWithApple = function signInWithApple() {\n    var credential, appleUserInfoRef;\n    return _regeneratorRuntime.async(function signInWithApple$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            _context4.next = 3;\n            return _regeneratorRuntime.awrap(AppleAuthentication.signInAsync({\n              requestedScopes: [AppleAuthentication.AppleAuthenticationScope.FULL_NAME, AppleAuthentication.AppleAuthenticationScope.EMAIL]\n            }));\n\n          case 3:\n            credential = _context4.sent;\n            console.log(credential);\n            _context4.next = 7;\n            return _regeneratorRuntime.awrap(appleSignUp(credential.email, credential.fullName.givenName, credential.fullName.familyName, credential.user));\n\n          case 7:\n            console.log(\"signUpWithApple!\");\n            _context4.next = 10;\n            return _regeneratorRuntime.awrap(firebase.database().ref(credential.user).child('appleUserInfo'));\n\n          case 10:\n            appleUserInfoRef = _context4.sent;\n            _context4.next = 13;\n            return _regeneratorRuntime.awrap(appleUserInfoRef.once('value', function _callee(snapshot) {\n              return _regeneratorRuntime.async(function _callee$(_context3) {\n                while (1) {\n                  switch (_context3.prev = _context3.next) {\n                    case 0:\n                      if (snapshot.val() === null) {\n                        console.log(\"no appleUserInfo Object!\");\n                      }\n\n                    case 1:\n                    case \"end\":\n                      return _context3.stop();\n                  }\n                }\n              }, null, null, null, Promise);\n            }));\n\n          case 13:\n            _context4.next = 18;\n            break;\n\n          case 15:\n            _context4.prev = 15;\n            _context4.t0 = _context4[\"catch\"](0);\n\n            if (_context4.t0.code === 'ERR_CANCELED') {} else {}\n\n          case 18:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[0, 15]], Promise);\n  };\n\n  var currUser = firebase.auth().currentUser;\n  useEffect(function () {\n    if (currUser && !currUser.isAnonymous) {\n      navigation.navigate('UserWelcomeScreen');\n    }\n  }, [userToken, currUser]);\n  return React.createElement(Animatable.View, {\n    style: styles.footerIntro,\n    animation: \"fadeInUpBig\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: {\n      fontSize: height < 600 ? 20 : height < 700 ? 22 : 25,\n      color: \"#535353\",\n      textAlign: \"center\",\n      width: 290,\n      fontFamily: \"Assistant-SemiBold\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }\n  }, \"Create a Free Account to View Your Favorites, Track Progress, and more.\")), React.createElement(View, {\n    style: {\n      height: 250,\n      justifyContent: height < 600 ? \"space-around\" : \"space-between\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }\n  }, React.createElement(AppButton, {\n    title: \"Sign in with Facebook\",\n    buttonStyles: styles.facebookButton,\n    buttonTextStyles: styles.buttonText,\n    onPress: signInWithFacebook,\n    icon: \"FontAwesome\",\n    name: \"facebook-square\",\n    size: 28,\n    color: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 9\n    }\n  }), React.createElement(AppButton, {\n    title: \"Sign in with Apple\",\n    buttonStyles: styles.appleButton,\n    buttonTextStyles: styles.buttonText,\n    onPress: signInWithApple,\n    icon: \"Fontisto\",\n    name: \"apple\",\n    size: 28,\n    color: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 9\n    }\n  }), React.createElement(AppButton, {\n    title: \"Sign up with Email\",\n    buttonStyles: styles.emailButton,\n    buttonTextStyles: styles.emailButtonText,\n    onPress: function onPress() {\n      return navigation.navigate('SignUpScreen');\n    },\n    icon: \"Fontisto\",\n    name: \"email\",\n    size: 28,\n    color: \"black\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 9\n    }\n  })), React.createElement(View, {\n    style: {\n      alignItems: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: {\n      fontSize: 15,\n      color: \"#535353\",\n      fontFamily: \"Assistant-SemiBold\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 9\n    }\n  }, \"Already Have an Account?\"), React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return navigation.navigate('SignInScreen');\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: {\n      fontSize: height < 600 ? 18 : 20,\n      color: \"#535353\",\n      fontFamily: \"Assistant-SemiBold\",\n      padding: 10,\n      paddingLeft: 20,\n      paddingRight: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 11\n    }\n  }, \"Log-In\"))));\n}\nvar styles = StyleSheet.create({\n  footerIntro: {\n    width: width,\n    flex: 4.5,\n    height: Math.min(height * 0.79, 600),\n    position: \"absolute\",\n    bottom: 0,\n    backgroundColor: '#fff',\n    borderTopLeftRadius: 30,\n    borderTopRightRadius: 30,\n    paddingVertical: 40,\n    paddingHorizontal: 45,\n    justifyContent: height < 600 ? \"space-between\" : \"space-evenly\",\n    alignItems: \"center\"\n  },\n  facebookButton: {\n    backgroundColor: \"#3681C7\",\n    height: height < 600 ? 55 : height < 700 ? 59 : 63,\n    width: width < 350 ? width * 0.85 : 327,\n    borderRadius: 7,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  buttonText: {\n    color: \"#fff\",\n    flex: 1,\n    textAlign: \"center\",\n    fontSize: height < 600 ? 19 : height < 700 ? 21 : 23,\n    fontFamily: \"Assistant-SemiBold\"\n  },\n  appleButton: {\n    backgroundColor: \"#1E1E1E\",\n    height: height < 600 ? 55 : height < 700 ? 59 : 63,\n    width: width < 350 ? width * 0.85 : 327,\n    borderRadius: 7,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  emailButton: {\n    backgroundColor: \"#FFF\",\n    height: height < 600 ? 55 : height < 700 ? 59 : 63,\n    width: width < 350 ? width * 0.85 : 327,\n    borderWidth: 2,\n    borderRadius: 7,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  emailButtonText: {\n    color: \"#1E1E1E\",\n    flex: 1,\n    textAlign: \"center\",\n    fontSize: height < 600 ? 19 : height < 700 ? 21 : 23,\n    fontFamily: \"Assistant-SemiBold\"\n  }\n});","map":{"version":3,"sources":["/Users/stanleyjeong/Desktop/_CODING/_PROJECTS 25 projects/z_SJ_Portfolio 2020/MEMOIR/Memoir/components/CreateAccountPopup.jsx"],"names":["React","useEffect","useContext","useFonts","useNavigation","AuthContext","AppButton","Animatable","Dimensions","get","width","height","firebase","provider","auth","FacebookAuthProvider","Facebook","AppleAuthentication","CreateAccountPopup","navigation","require","fontsLoaded","appleSignUp","appleTokenIn","userToken","fbSignUp","fbTokenIn","fbAppId","fbAppName","signInWithFacebook","initializeAsync","logInWithReadPermissionsAsync","permissions","type","token","console","log","fetch","response","json","first_name","last_name","email","userId","fbSignIn","signInWithPopup","then","result","credential","accessToken","user","catch","error","code","message","signInWithApple","signInAsync","requestedScopes","AppleAuthenticationScope","FULL_NAME","EMAIL","fullName","givenName","familyName","database","ref","child","appleUserInfoRef","once","snapshot","val","currUser","currentUser","isAnonymous","navigate","styles","footerIntro","fontSize","color","textAlign","fontFamily","justifyContent","facebookButton","buttonText","appleButton","emailButton","emailButtonText","alignItems","padding","paddingLeft","paddingRight","StyleSheet","create","flex","Math","min","position","bottom","backgroundColor","borderTopLeftRadius","borderTopRightRadius","paddingVertical","paddingHorizontal","borderRadius","borderWidth"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext } from 'react';\nimport { Text, View, StyleSheet, Dimensions, TouchableOpacity } from 'react-native';\nimport { useFonts } from 'expo-font';\nimport { useNavigation } from '@react-navigation/native';\nimport { AuthContext } from '../components/context';\nimport AppButton from './AppButton';\nimport * as Animatable from 'react-native-animatable';\nconst { width, height } = Dimensions.get('window');\n\n// Firebase setup for FB\nimport firebase from 'firebase';\nconst provider = new firebase.auth.FacebookAuthProvider();\n\n// Expo APIs\nimport * as Facebook from 'expo-facebook';\nimport * as AppleAuthentication from 'expo-apple-authentication';\n\nexport default function CreateAccountPopup() {\n  const navigation = useNavigation();\n\n  let [fontsLoaded] = useFonts({\n    'Assistant': require('../assets/fonts/Assistant/Assistant-VariableFont_wght.ttf'),\n    'Assistant-Regular': require('../assets/fonts/Assistant/static/Assistant-Regular.ttf'),\n    'Assistant-SemiBold': require('../assets/fonts/Assistant/static/Assistant-SemiBold.ttf'),\n  });\n\n  const { appleSignUp, appleTokenIn, userToken, fbSignUp, fbTokenIn } = useContext(AuthContext);\n\n  const fbAppId = \"200817071551403\";\n  const fbAppName = 'memoir'\n\n  const signInWithFacebook = async () => {\n    await Facebook.initializeAsync({fbAppId, fbAppName});\n    const {type, token} =  await Facebook.logInWithReadPermissionsAsync({ permissions: ['public_profile', 'email', 'user_friends'] })\n    console.log(\"Token: \", token)\n    if (type === \"success\") {\n      const response = await fetch(`https://graph.facebook.com/me?access_token=${token}&fields=id,first_name,last_name,email`)\n      const json = await response.json();\n      console.log(\"facebook response: \", json);\n      \n      const first_name = json[\"first_name\"];\n      const last_name = json[\"last_name\"];\n      const email = json[\"email\"] || null;\n      const userId = json[\"id\"];\n      \n      console.log(\"fb name stuff!: \", first_name, last_name, email, userId, token);\n      try {\n        await fbSignUp(email, first_name, last_name, userId, token);\n      } catch (error) {\n        console.log(error);\n      }\n\n    } else {\n      // alert(type);\n    }\n  }\n\n  // Not working with latest Expo SDK? \n  // async function fbSignIn () {\n  //   try {\n  //     await Facebook.initializeAsync({\n  //       appId: '200817071551403',\n  //     });\n  //     const {type, token} = await Facebook.logInWithReadPermissionsAsync('200817071551403', { permissions: ['public_profile'] });\n\n  //     if (type == \"success\") {\n  //       const credential = firebase.auth.FacebookAuthProvider.credential(token)\n    \n  //       await firebase.auth().signUpWithCredential(credential).catch((error) => {\n  //         console.log(error)\n  //       })\n  //     }\n  //   } catch (error) {\n  //     console.log(`Facebook Login Error: ${error}`)\n  //   }\n  // };\n\n\n/* \nGOOGLE FIREBASE WEB APP FB WAY\nauth/operation-not-supported-in-this-environment \nThis operation is not supported in the environment this application is runningon. \n\"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.\n*/\n  async function fbSignIn () {\n    firebase.auth().signInWithPopup(provider)\n\n    .then(function(result) {\n      var token = result.credential.accessToken;\n      var user = result.user;\n\n      // console.log(token)\n      // console.log(user)\n    }).catch(function(error) {\n      console.log(error.code);\n      console.log(error.message);\n    })\n  };\n  \n\n\n\n// Firebase way failed\n// const provider = new firebase.auth.OAuthProvider('apple.com');\n\n// const signInWithAppleFireBase = () => {\n//   firebase.auth().signInWithRedirect(provider);\n// }\n\n\n// EXPO AppleAuthentication + FIREBASE WEB APP WORKAROUND\nconst signInWithApple = async () => {\n  try {\n    const credential = await AppleAuthentication.signInAsync({\n      requestedScopes: [\n        AppleAuthentication.AppleAuthenticationScope.FULL_NAME,\n        AppleAuthentication.AppleAuthenticationScope.EMAIL,\n      ],\n    });\n\n    // if (credential.email !== null || credential.fullName.givenName !== null) {\n    //   // create a new account with SignUp method with email, name, and userIdtoken.\n    //   await appleSignUp(credential.email, credential.fullName.givenName, credential.fullName.familyName, credential.user)\n    //   console.log(\"signUpWithApple!\")\n    // } else {\n    //   // just send over the userToken\n    //   await appleTokenIn(credential.user);\n    //   console.log(\"tokenwithApple!\")\n    // }\n\n    // signed in\n    console.log(credential);\n    await appleSignUp(credential.email, credential.fullName.givenName, credential.fullName.familyName, credential.user)\n    console.log(\"signUpWithApple!\")\n\n    const appleUserInfoRef = await firebase.database().ref(credential.user).child('appleUserInfo');\n    await appleUserInfoRef.once('value', async snapshot => {\n      if (snapshot.val() === null) {\n        console.log(\"no appleUserInfo Object!\")\n      }\n    })\n\n  } catch (e) {\n    if (e.code === 'ERR_CANCELED') {\n      // alert(e);\n      // handle that the user canceled the sign-in flow\n    } else {\n      // handle other errors\n    }\n  }\n}\n\n\nconst currUser = firebase.auth().currentUser;\n\nuseEffect(() => {\n  if (currUser && !currUser.isAnonymous) {\n    navigation.navigate('UserWelcomeScreen')\n  }\n}, [userToken, currUser])\n\n\n  return (\n    <Animatable.View style={styles.footerIntro} animation=\"fadeInUpBig\">\n      <View>\n        <Text style={{fontSize: height < 600 ? 20 : height < 700 ? 22 : 25, color: \"#535353\", textAlign: \"center\", width: 290, fontFamily: \"Assistant-SemiBold\", }}>Create a Free Account to View Your Favorites, Track Progress, and more.</Text>\n      </View>\n      <View style={{ height: 250, justifyContent:  height < 600 ? \"space-around\" : \"space-between\"}}>\n        <AppButton \n          title=\"Sign in with Facebook\" \n          buttonStyles={styles.facebookButton} \n          buttonTextStyles={styles.buttonText} \n          onPress={signInWithFacebook}\n          icon={\"FontAwesome\"}\n          name={\"facebook-square\"}\n          size={28}\n          color={\"white\"}\n        />\n        <AppButton \n          title=\"Sign in with Apple\" \n          buttonStyles={styles.appleButton} \n          buttonTextStyles={styles.buttonText} \n          onPress={signInWithApple}\n          icon={\"Fontisto\"}\n          name={\"apple\"}\n          size={28}\n          color={\"white\"}\n        />\n\n      {/* <AppleAuthentication.AppleAuthenticationButton\n        buttonType={AppleAuthentication.AppleAuthenticationButtonType.SIGN_IN}\n        buttonStyle={AppleAuthentication.AppleAuthenticationButtonStyle.BLACK}\n        cornerRadius={5}\n        style={{ width: 327, height: 63 }}\n        onPress={}\n      /> */}\n        \n        <AppButton \n          title=\"Sign up with Email\" \n          buttonStyles={styles.emailButton} \n          buttonTextStyles={styles.emailButtonText} \n          onPress={() => navigation.navigate('SignUpScreen')}\n          icon={\"Fontisto\"}\n          name={\"email\"}\n          size={28}\n          color={\"black\"}\n        />\n      </View>\n      <View style={{alignItems: \"center\"}}>\n        <Text style={{fontSize: 15, color: \"#535353\", fontFamily: \"Assistant-SemiBold\"}}>Already Have an Account?</Text>\n        <TouchableOpacity onPress={() => navigation.navigate('SignInScreen')}>\n          <Text style={{fontSize: height < 600 ? 18 : 20, color: \"#535353\", fontFamily: \"Assistant-SemiBold\", padding: 10, paddingLeft: 20, paddingRight: 20, }}>Log-In</Text>\n        </TouchableOpacity>\n\n        {/* <Button style={{fontSize: 20, color: \"#535353\", fontFamily: \"Assistant-SemiBold\"}} title=\"Log-In\" onPress={() => navigation.navigate('SignInScreen')}></Button> */}\n      \n      </View>\n    </Animatable.View>\n  )\n}\n\n\nconst styles = StyleSheet.create({\n  footerIntro: {\n    width: width,\n    flex: 4.5,\n    height: Math.min(height * 0.79, 600),\n    // height: Math.min(height * 0.69),\n    position: \"absolute\",\n    bottom: 0,\n    backgroundColor: '#fff',\n    borderTopLeftRadius: 30,\n    borderTopRightRadius: 30,\n    paddingVertical: 40,\n    paddingHorizontal: 45,\n    justifyContent: height < 600 ? \"space-between\" : \"space-evenly\",\n    alignItems: \"center\"\n  },\n  facebookButton: {\n    backgroundColor: \"#3681C7\",\n    height: height < 600 ? 55 : height < 700 ? 59 : 63,\n    width: width < 350 ? width * 0.85 : 327,\n    borderRadius: 7,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  buttonText: {\n    color: \"#fff\",\n    flex: 1,\n    textAlign: \"center\",\n    fontSize: height < 600 ? 19 : height < 700 ? 21 : 23,\n    fontFamily: \"Assistant-SemiBold\"\n  },\n  appleButton: {\n    backgroundColor: \"#1E1E1E\",\n    height: height < 600 ? 55 : height < 700 ? 59 : 63,\n    width: width < 350 ? width * 0.85 : 327,\n    borderRadius: 7,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  emailButton: {\n    backgroundColor: \"#FFF\",\n    height: height < 600 ? 55 : height < 700 ? 59 : 63,\n    width: width < 350 ? width * 0.85 : 327,\n    borderWidth: 2,\n    borderRadius: 7,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  emailButtonText: {\n    color: \"#1E1E1E\",\n    flex: 1,\n    textAlign: \"center\",\n    fontSize: height < 600 ? 19 : height < 700 ? 21 : 23,\n    fontFamily: \"Assistant-SemiBold\",\n  }\n});"]},"metadata":{},"sourceType":"module"}